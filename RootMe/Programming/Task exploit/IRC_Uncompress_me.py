from pwn import *
import time
import re
import base64
import zlib

host = "irc.root-me.org"
port = 6667
protocol = b"IRC"
channel = b"#root-me_challenge"
bot = b"candy"

conn = remote(host, port)
conn.send(b'NICK b0ringdream \r\n')
time.sleep(1)
conn.send(b'USER b0ringdream irc.root-me.org root-me :MyBot \r\n')
time.sleep(1)
conn.send(b'JOIN ' + channel + b'\n')


conn.send(b'PRIVMSG ' + bot + b' !ep4\n')
while True: 
	text = conn.recv(7000).decode('UTF-8')
	print(text)
	ans = re.findall(r'(?<=:Candy!Candy@root-me.org PRIVMSG b0ringdream :).+(?=\r)', text)
	if ans:
		ans = ans[0]
		ans = base64.b64decode(ans)
		ans = zlib.decompress(ans)
		ans = bytes(ans)

		print('Начальная строка = ' + str(ans))
		conn.send(b'PRIVMSG ' + bot + b' !ep4 -rep ' + ans + b'\n')
		print(conn.recv(7000).decode('UTF-8'))
		break
	
	