from pwn import *
import time
import re
import codecs

host = "irc.root-me.org"
port = 6667
protocol = b"IRC"
channel = b"#root-me_challenge"
bot = b"candy"

conn = remote(host, port)
conn.send(b'NICK b0ringdream \r\n')
time.sleep(1)
conn.send(b'USER b0ringdream irc.root-me.org root-me :MyBot \r\n')
time.sleep(1)
conn.send(b'JOIN ' + channel + b'\n')


conn.send(b'PRIVMSG ' + bot + b' !ep3\n')
while True: 
	text = conn.recv(7000).decode('UTF-8')
	print(text)
	ans = re.findall(r'(?<=:Candy!Candy@root-me.org PRIVMSG b0ringdream :).+', text)
	if ans: 
		ans = ans[0]
		print('Строка : ' + str(ans))
		ans = codecs.decode(ans,'rot_13')
		print('Декодирование :' + str(ans))
		ans = bytes(ans,encoding='UTF-8')

		conn.send(b'PRIVMSG ' + bot + b' !ep3 -rep ' + ans + b'\n')
		print(conn.recv(7000).decode('UTF-8'))
		break	